#!/bin/sh
#
# dot
#
# `dot` handles installation, updates, things like that. Run it periodically
# to make sure you're on the latest and greatest.

# Ask for the administrator password upfront
sudo -v -p "\
  Installing and updating software may require a password.\
  Enter your password: "

export ZSH=$HOME/.dotfiles

# If we're on a Mac, do some Homebrew stuff
if [ "$(uname)" == "Darwin" ]; then
  # Set OS X defaults
  $ZSH/osx/set-defaults.sh

  # Install homebrew
  $ZSH/homebrew/install.sh 2>&1

  # Install Brew packages
  cd "$(dirname $0)"/..
  echo "> brew bundle"
  brew bundle

  # Upgrade homebrew
  echo "â€º brew update"
  brew update

  echo "> brew upgrade"
  brew upgrade

  # Do some housekeeping
  echo "> brew cleanup"
  brew cleanup

  # Ensure python neovim is installed
  echo "> sudo pip3 install neovim"
  sudo pip3 install neovim
fi

# Install software
echo "â€º $ZSH/script/install"
$ZSH/script/install

# Install vim plugins
# Sadly, this can't be done in an install.sh because vim expects a terminal input
ln -s ~/.vim ~/.config/nvim
ln -s ~/.vimrc ~/.config/nvim/init.vim
# Pass this through `yes` to dismiss warnings about missing plugins we're about to install
yes | vim +PlugClean! +PlugInstall! +qall >/dev/tty

